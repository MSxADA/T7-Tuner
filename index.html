<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Douk T7 Ultimate Tuner</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        body {
            background-color: #020617; /* Slate 950 */
            color: white;
        }
        .knob-transition {
            transition: transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        // --- INTERNAL ICONS ---
        const Icon = ({ path, size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>{path}</svg>
        );

        const ICONS = {
            Headphones: <path d="M3 14v-3a9 9 0 0 1 18 0v3M3 19a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2h-2z" />,
            Speaker: <path d="M12 6L8 10H4v4h4l4 4V6zM17 7a5 5 0 0 1 0 10M15.5 10.5a2.5 2.5 0 0 1 0 3" />,
            Music: <path d="M9 18V5l12-2v13M9 9l12-2M6 18a3 3 0 1 0 0-6 3 3 0 0 0 0 6z" />,
            Sliders: <path d="M4 21v-7M4 10V3M12 21v-9M12 8V3M20 21v-5M20 12V3M1 14h6M9 8h6M17 16h6" />,
            Info: <><circle cx="12" cy="12" r="10" /><line x1="12" y1="16" x2="12" y2="12" /><line x1="12" y1="8" x2="12.01" y2="8" /></>,
            CheckCircle: <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14M22 4L12 14.01l-3-3" />
        };

        const DoukT7Visualizer = () => {
            // Knob Configuration
            const MIN_DEG = -150;
            const MAX_DEG = 150;
            const MIN_DB = -6;
            const MAX_DB = 6;

            // Output Definitions
            const outputs = {
                lcd2c: {
                    name: "Audeze LCD-2C",
                    desc: "Stock: Warm & Dark. Needs air & upper-mids.",
                    color: "from-amber-700 to-orange-500",
                    iconColor: "text-amber-500",
                    borderColor: "border-amber-500",
                    shadowColor: "shadow-amber-500/20",
                    icon: ICONS.Headphones
                },
                arya: {
                    name: "Hifiman Arya",
                    desc: "Stock: Bright & Airy. Needs warmth & treble taming.",
                    color: "from-cyan-700 to-blue-500",
                    iconColor: "text-cyan-400",
                    borderColor: "border-cyan-500",
                    shadowColor: "shadow-cyan-400/20",
                    icon: ICONS.Headphones
                },
                stereo: {
                    name: "Def Tech DM60",
                    desc: "Stereo Mode: Tames room boom & tweeter glare.",
                    color: "from-emerald-700 to-green-500",
                    iconColor: "text-emerald-400",
                    borderColor: "border-emerald-500",
                    shadowColor: "shadow-emerald-400/20",
                    icon: ICONS.Speaker
                }
            };

            const [selectedOutput, setSelectedOutput] = useState('lcd2c');
            const [activePresetKey, setActivePresetKey] = useState('neutral');
            const [activeCategory, setActiveCategory] = useState('calibration'); 

            const dbToDeg = (db) => ((db - MIN_DB) / (MAX_DB - MIN_DB)) * (MAX_DEG - MIN_DEG) + MIN_DEG;
            
            const dbToClock = (db) => {
                if (Math.abs(db) < 0.2) return "12:00";
                let hour = 12 + (db / 1.2);
                if (hour > 12.99) hour -= 12;
                if (hour < 1) hour += 12;
                const m = Math.round((hour - Math.floor(hour)) * 60);
                return `${Math.floor(hour)}:${m < 10 ? '0' + m : m}`;
            };

            // PRESET VALUES [LCD-2C, Arya, Stereo]
            // Index 0: LCD-2C (Dark Planar)
            // Index 1: Arya (Bright Planar)
            // Index 2: Def Tech DM60 (Stereo Tower)
            const categories = {
                calibration: {
                    title: "Base Calibration",
                    icon: ICONS.Info,
                    items: {
                        neutral: {
                            name: "Stock / Reference",
                            desc: {
                                lcd2c: "Fixes the 'veil'. Boosts upper mids (2k/4k).",
                                arya: "Fixes the 'glare'. Cuts 4k/8k peaks.",
                                stereo: "Balanced Room. Cuts 125Hz 'room boom' and 4k 'metallic' tweeter harshness."
                            },
                            values: {
                                64: [0, 1, 0],
                                125: [0, 0, -1.5], // Cut room boom in stereo
                                250: [0, 0, 0],
                                500: [0, 0, 0.5], // Add body to towers
                                '2k': [1.5, 0, -1], // Cut presence for depth
                                '4k': [4.5, -2, -1], // Soften alum tweeter
                                '8k': [3, -3, 0]
                            }
                        }
                    }
                },
                styles: {
                    title: "Listening Styles",
                    icon: ICONS.Sliders,
                    items: {
                        warmth: {
                            name: "Fuller Bass & Warmth",
                            desc: {
                                lcd2c: "Thickens low end.",
                                arya: "Essential body adder.",
                                stereo: "Tube-like warmth. Boosts mid-bass to fill the room."
                            },
                            values: { 
                                64: [3.5, 4.5, 2], 
                                125: [4, 4, 3], // Warmth
                                250: [2, 2, 2],
                                500: [0, 0, 0],
                                '2k': [-1, -1, -1],
                                '4k': [-1, -3, -2], 
                                '8k': [0, -3, -2]
                            }
                        },
                        energetic: {
                            name: "Energetic & Forward",
                            desc: {
                                lcd2c: "Brings vocals closer.",
                                arya: "Very aggressive detail.",
                                stereo: "Live concert feel. Danger of tweeter harshness."
                            },
                            values: {
                                64: [1, 2, 1],
                                125: [0, 1, 0],
                                250: [-1, 0, -1],
                                500: [0, -1, 0],
                                '2k': [2, 0, 1],
                                '4k': [3, -1, 1], 
                                '8k': [4, 1, 2]
                            }
                        },
                        smooth: {
                            name: "Smooth & Relaxed",
                            desc: {
                                lcd2c: "Anti-shout cut.",
                                arya: "De-Esser mode.",
                                stereo: "Late night lounge. Removes all aluminum tweeter edge."
                            },
                            values: {
                                64: [1, 2.5, 1],
                                125: [1, 2, 1],
                                250: [0, 1, 0],
                                500: [0, 0, 0],
                                '2k': [-3.5, -2, -2],
                                '4k': [-1, -4, -2], 
                                '8k': [2, -4, -3]
                            }
                        },
                        theater: {
                            name: "Theater / Cinema",
                            desc: {
                                lcd2c: "Rumble & dialogue.",
                                arya: "Cinematic weight.",
                                stereo: "Blockbuster mode. Huge Sub-bass (64Hz) + Dialogue lift (2k)."
                            },
                            values: {
                                64: [5, 6, 4], // Let powered subs handle lower, boost mid-kick
                                125: [2, 3, 1],
                                250: [0, 1, 0],
                                500: [-2, -1, -1],
                                '2k': [2, 0, 2], // Dialogue clarity
                                '4k': [3, -1, 0],
                                '8k': [4, 0, 2]
                            }
                        }
                    }
                },
                genres: {
                    title: "Music Genres",
                    icon: ICONS.Music,
                    items: {
                        classicrock: {
                            name: "Classic Rock",
                            desc: {
                                lcd2c: "Groove mode.",
                                arya: "Vintage warmth.",
                                stereo: "70s Hi-Fi sound. Boosts 125Hz for bass guitar groove."
                            },
                            values: {
                                64: [2, 3, 1],
                                125: [3.5, 4, 3], // Bass guitar zone
                                250: [1, 2, 1],
                                500: [-1.5, -1, -1],
                                '2k': [-3.5, -2, -2],
                                '4k': [0, -2, -1], 
                                '8k': [3, -1, 1]
                            }
                        },
                        metal: {
                            name: "Metal",
                            desc: {
                                lcd2c: "Impact / Anti-shout.",
                                arya: "Needs bass slam.",
                                stereo: "Double-kick power (64Hz). Cuts 2k to save ears from guitar stack."
                            },
                            values: {
                                64: [4, 5, 4], 
                                125: [1.5, 3, 0], // Cut mud for fast kicks
                                250: [0, 1, 0],
                                500: [-2, -1, -1],
                                '2k': [-3, -2, -3], // Anti-Shout critical
                                '4k': [0.5, -2, 0],
                                '8k': [4, -1, 1]
                            }
                        },
                        jazz: {
                            name: "Jazz",
                            desc: {
                                lcd2c: "Cymbal detail.",
                                arya: "Double bass body.",
                                stereo: "Smoke-filled room. Cuts 4k trumpet glare, boosts bass texture."
                            },
                            values: {
                                64: [1, 2, 0],
                                125: [2.5, 3, 2],
                                250: [0, 1, 1],
                                500: [-1, 0, 0],
                                '2k': [-2.5, -2, -1],
                                '4k': [1, -2, -2], // Trumpet fix
                                '8k': [3.5, -1, 1]
                            }
                        },
                        electronic: {
                            name: "Electronic",
                            desc: {
                                lcd2c: "Sub-bass party.",
                                arya: "Bass cannon.",
                                stereo: "Club mode. Max slam on 64Hz. Sharp highs."
                            },
                            values: {
                                64: [5.5, 6, 5], 
                                125: [2, 3, 1],
                                250: [-1, 0, -1],
                                500: [-2, -1, -2],
                                '2k': [-1, -1, 0],
                                '4k': [2, 0, 1],
                                '8k': [5, 1, 3]
                            }
                        }
                    }
                }
            };

            const handleOutputSwitch = (key) => {
                setSelectedOutput(key);
                setActivePresetKey('neutral');
                setActiveCategory('calibration');
            };

            // Determine Index: 0=LCD, 1=Arya, 2=Stereo
            const getIndex = (key) => {
                if(key === 'lcd2c') return 0;
                if(key === 'arya') return 1;
                return 2;
            };
            
            const hpIndex = getIndex(selectedOutput);
            
            // Get active preset values
            const allPresets = { ...categories.calibration.items, ...categories.styles.items, ...categories.genres.items };
            const activePreset = allPresets[activePresetKey];
            const currentValues = {};
            if (activePreset) {
                Object.keys(activePreset.values).forEach(key => {
                    // Fallback if stereo index doesn't exist yet (safety)
                    const valArr = activePreset.values[key];
                    currentValues[key] = valArr[hpIndex] !== undefined ? valArr[hpIndex] : valArr[0];
                });
            }
            const currentDesc = activePreset ? activePreset.desc[selectedOutput] : "";
            const currentOutputDef = outputs[selectedOutput];

            return (
                <div className="min-h-screen bg-slate-950 text-slate-100 font-sans p-4 md:p-8 flex flex-col items-center selection:bg-purple-500 selection:text-white">
                    
                    {/* Header */}
                    <div className="w-full max-w-6xl mb-6 text-center pt-2">
                        <h1 className="text-3xl md:text-5xl font-black bg-gradient-to-r from-slate-200 via-white to-slate-200 bg-clip-text text-transparent mb-2 tracking-tight">
                            DOUK T7 <span className={currentOutputDef.iconColor.replace('text-', 'text-')}>TUNER</span>
                        </h1>
                        <p className="text-slate-400 text-sm font-medium uppercase tracking-widest">Digital Knob Assistant</p>
                    </div>

                    {/* Output Selector */}
                    <div className="w-full max-w-4xl grid grid-cols-3 gap-4 mb-8">
                        {Object.entries(outputs).map(([key, hp]) => (
                            <button
                                key={key}
                                onClick={() => handleOutputSwitch(key)}
                                className={`relative p-4 rounded-2xl border-2 transition-all duration-300 flex flex-col items-center gap-2 overflow-hidden group ${
                                    selectedOutput === key 
                                        ? `bg-slate-900 ${hp.borderColor} shadow-2xl ${hp.shadowColor} scale-[1.02]` 
                                        : 'bg-slate-900/40 border-slate-800 hover:bg-slate-800 hover:border-slate-700 opacity-60 hover:opacity-100'
                                }`}
                            >
                                <div className={`absolute top-0 left-0 w-full h-1 bg-gradient-to-r ${hp.color} opacity-80`}></div>
                                <div className="flex items-center gap-2 z-10">
                                    <Icon path={hp.icon} size={20} className={selectedOutput === key ? hp.iconColor : 'text-slate-500'} />
                                    <span className={`font-bold text-sm md:text-base ${selectedOutput === key ? 'text-white' : 'text-slate-400'}`}>{hp.name}</span>
                                </div>
                                {selectedOutput === key && (
                                    <div className={`absolute -right-3 -bottom-3 opacity-10 text-${hp.iconColor.split('-')[1]}`}>
                                        <Icon path={ICONS.CheckCircle} size={64} />
                                    </div>
                                )}
                            </button>
                        ))}
                    </div>

                    <div className="w-full max-w-6xl grid grid-cols-1 lg:grid-cols-12 gap-8">
                        
                        {/* LEFT COLUMN: Controls */}
                        <div className="lg:col-span-5 flex flex-col gap-6">
                            
                            {/* Styles */}
                            <div className="bg-slate-900/50 border border-slate-800 rounded-2xl p-5 shadow-lg backdrop-blur-sm relative overflow-hidden">
                                <div className="absolute top-0 right-0 w-20 h-20 bg-purple-500/5 rounded-full blur-2xl"></div>
                                <h2 className="text-xs font-bold text-slate-500 uppercase tracking-widest mb-4 flex items-center gap-2 relative z-10">
                                    <Icon path={categories.styles.icon} size={16} />
                                    {categories.styles.title}
                                </h2>
                                <div className="grid grid-cols-2 gap-2 relative z-10">
                                    {Object.entries(categories.styles.items).map(([key, item]) => (
                                        <button
                                            key={key}
                                            onClick={() => { setActiveCategory('styles'); setActivePresetKey(key); }}
                                            className={`px-3 py-3 rounded-lg text-sm font-medium transition-all duration-200 text-left relative overflow-hidden group ${
                                                activePresetKey === key 
                                                    ? `bg-slate-800 text-white border-l-4 ${currentOutputDef.borderColor.replace('border-','border-')} shadow-lg` 
                                                    : 'bg-slate-800/40 text-slate-400 border border-transparent hover:bg-slate-800'
                                            }`}
                                        >
                                            <span className="relative z-10">{item.name}</span>
                                        </button>
                                    ))}
                                </div>
                            </div>

                            {/* Genres */}
                            <div className="bg-slate-900/50 border border-slate-800 rounded-2xl p-5 shadow-lg backdrop-blur-sm relative overflow-hidden">
                                <div className="absolute bottom-0 left-0 w-20 h-20 bg-blue-500/5 rounded-full blur-2xl"></div>
                                <h2 className="text-xs font-bold text-slate-500 uppercase tracking-widest mb-4 flex items-center gap-2 relative z-10">
                                    <Icon path={categories.genres.icon} size={16} />
                                    {categories.genres.title}
                                </h2>
                                <div className="grid grid-cols-2 sm:grid-cols-3 gap-2 relative z-10">
                                    {Object.entries(categories.genres.items).map(([key, item]) => (
                    
