<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Douk T7 Tuner</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #020617; color: white; font-family: system-ui, sans-serif; }
        
        /* Knob Animation */
        .knob-inner { transition: transform 0.6s cubic-bezier(0.1, 1.2, 0.3, 1); }
        
        /* Utility to hide scrollbars */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        /* Custom Button Styles */
        .btn-base {
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
        }
        .btn-base:active { transform: scale(0.98); }
        
    </style>
</head>
<body class="min-h-screen flex flex-col items-center p-4 md:p-8">

    <!-- Header -->
    <div class="text-center mb-8">
        <h1 class="text-4xl md:text-5xl font-black text-white mb-2 tracking-tight">
            DOUK T7 <span id="header-accent" class="text-amber-500">TUNER</span>
        </h1>
        <p class="text-slate-500 text-xs font-bold uppercase tracking-[0.3em]">Native Calibration Tool</p>
    </div>

    <!-- Output Selector -->
    <div class="w-full max-w-4xl grid grid-cols-3 gap-3 md:gap-6 mb-10" id="output-container">
        <!-- Javascript will insert buttons here -->
    </div>

    <div class="w-full max-w-7xl grid grid-cols-1 lg:grid-cols-12 gap-8">
        
        <!-- Left Column: Controls -->
        <div class="lg:col-span-4 flex flex-col gap-6">
            <!-- Styles Group -->
            <div class="bg-slate-900/50 border border-slate-800 rounded-2xl p-5 shadow-lg">
                <h3 class="text-xs font-bold text-slate-500 uppercase tracking-widest mb-4 flex items-center gap-2">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 21v-7M4 10V3M12 21v-9M12 8V3M20 21v-5M20 12V3M1 14h6M9 8h6M17 16h6"/></svg>
                    Listening Styles
                </h3>
                <div class="grid grid-cols-2 gap-2" id="styles-container"></div>
            </div>

            <!-- Genres Group -->
            <div class="bg-slate-900/50 border border-slate-800 rounded-2xl p-5 shadow-lg">
                <h3 class="text-xs font-bold text-slate-500 uppercase tracking-widest mb-4 flex items-center gap-2">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 18V5l12-2v13M9 9l12-2M6 18a3 3 0 1 0 0-6 3 3 0 0 0 0 6zM18 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
                    Music Genres
                </h3>
                <div class="grid grid-cols-2 gap-2" id="genres-container"></div>
            </div>
        </div>

        <!-- Right Column: Visualizer -->
        <div class="lg:col-span-8">
            <div class="w-full bg-slate-900 rounded-3xl border border-slate-700 p-6 md:p-10 shadow-2xl relative overflow-hidden min-h-[500px] flex flex-col justify-center">
                
                <!-- Dynamic Backgrounds -->
                <div id="bg-glow" class="absolute top-0 left-0 w-full h-1 opacity-60 transition-colors duration-500"></div>
                <div id="bg-blob" class="absolute -top-40 -right-40 w-96 h-96 rounded-full blur-3xl pointer-events-none opacity-5 transition-colors duration-500"></div>

                <!-- Info Panel -->
                <div class="mb-12 relative z-10">
                    <div class="flex items-center justify-between mb-4">
                        <h2 id="preset-name" class="text-3xl font-bold text-white">Loading...</h2>
                        <span id="mode-badge" class="px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider border transition-colors duration-300">
                            Mode
                        </span>
                    </div>
                    <div class="flex gap-3 border-l-2 border-slate-700 pl-4">
                        <svg id="info-icon" class="mt-1 text-slate-500" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
                        <p id="preset-desc" class="text-slate-300 text-sm leading-relaxed">Select a preset to begin.</p>
                    </div>
                </div>

                <!-- KNOBS GRID -->
                <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-y-12 gap-x-4 justify-items-center relative z-10" id="knobs-row">
                    <!-- Knobs will be injected here by JS -->
                </div>
            </div>
        </div>
    </div>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        // --- DATA ---
        const CONFIG = {
            lcd2c: { id:'lcd2c', name:"Audeze LCD-2C", icon:"ðŸŽ§", color:"#f59e0b" },
            arya: { id:'arya', name:"Hifiman Arya", icon:"ðŸŽ§", color:"#22d3ee" },
            stereo: { id:'stereo', name:"Def Tech DM60", icon:"ðŸ”Š", color:"#10b981" }
        };

        const PRESETS = {
            // Calibration
            neutral: { name: "Stock / Neutral", desc: { lcd2c:"Restores mids/air.", arya:"Tames glare.", stereo:"Balanced room." }, vals: {64:[0,1,0],125:[0,0,-1.5],250:[0,0,0],500:[0,0,0.5],'2k':[1.5,0,-1],'4k':[4.5,-2,-1],'8k':[3,-3,0]} },
            // Styles
            warmth: { name: "Fuller Bass", desc: { lcd2c:"Thickens low end.", arya:"Adds body.", stereo:"Tube warmth." }, vals: {64:[3.5,4.5,2],125:[4,4,3],250:[2,2,2],500:[0,0,0],'2k':[-1,-1,-1],'4k':[-1,-3,-2],'8k':[0,-3,-2]} },
            energetic: { name: "Energetic", desc: { lcd2c:"Vocals closer.", arya:"Aggressive.", stereo:"Live concert." }, vals: {64:[1,2,1],125:[0,1,0],250:[-1,0,-1],500:[0,-1,0],'2k':[2,0,1],'4k':[3,-1,1],'8k':[4,1,2]} },
            crisp: { name: "Crisp Detail", desc: { lcd2c:"Max clarity.", arya:"Detail w/o hiss.", stereo:"Vocal focus." }, vals: {64:[0,1,0],125:[-1,0,-2],250:[0,0,-1],500:[-2.5,-1,-1],'2k':[0,-1,0],'4k':[3,0,-1],'8k':[5,-2,0]} },
            smooth: { name: "Smooth", desc: { lcd2c:"Anti-shout.", arya:"De-Esser.", stereo:"Late night lounge." }, vals: {64:[1,2.5,1],125:[1,2,1],250:[0,1,0],500:[0,0,0],'2k':[-3.5,-2,-2],'4k':[-1,-4,-2],'8k':[2,-4,-3]} },
            latenight: { name: "Late Night", desc: { lcd2c:"Loudness contour.", arya:"Low vol fullness.", stereo:"Low vol clarity." }, vals: {64:[4.5,5,3],125:[3,3,1],250:[1,1,1],500:[0,0,0],'2k':[-1,-1,-1],'4k':[2,-1,-1],'8k':[5,1,0]} },
            theater: { name: "Theater", desc: { lcd2c:"Rumble/dialogue.", arya:"Cinematic.", stereo:"Blockbuster." }, vals: {64:[5,6,4],125:[2,3,1],250:[0,1,0],500:[-2,-1,-1],'2k':[2,0,2],'4k':[3,-1,0],'8k':[4,0,2]} },
            // Genres
            classicrock: { name: "Classic Rock", desc: { lcd2c:"Groove mode.", arya:"Vintage warmth.", stereo:"70s Hi-Fi." }, vals: {64:[2,3,1],125:[3.5,4,3],250:[1,2,1],500:[-1.5,-1,-1],'2k':[-3.5,-2,-2],'4k':[0,-2,-1],'8k':[3,-1,1]} },
            pop: { name: "Pop", desc: { lcd2c:"V-Shape.", arya:"Bass boost.", stereo:"Radio ready." }, vals: {64:[3,4,2],125:[1,2,0],250:[-1,0,-1],500:[-1,-1,0],'2k':[0,-1,-1],'4k':[2,-1,-1],'8k':[4,0,1]} },
            metal: { name: "Metal", desc: { lcd2c:"Impact/Anti-shout.", arya:"Bass slam.", stereo:"Double-kick." }, vals: {64:[4,5,4],125:[1.5,3,0],250:[0,1,0],500:[-2,-1,-1],'2k':[-3,-2,-3],'4k':[0.5,-2,0],'8k':[4,-1,1]} },
            stoner: { name: "Stoner Metal", desc: { lcd2c:"Wall of fuzz.", arya:"Thick.", stereo:"Warm & Heavy." }, vals: {64:[2.5,4,2],125:[4.5,5,2],250:[3,3,1],500:[0,1,1],'2k':[-2,-2,-2],'4k':[-1,-3,-2],'8k':[1,-3,-2]} },
            jazz: { name: "Jazz", desc: { lcd2c:"Cymbal detail.", arya:"Double bass.", stereo:"Smoke-filled room." }, vals: {64:[1,2,0],125:[2.5,3,2],250:[0,1,1],500:[-1,0,0],'2k':[-2.5,-2,-1],'4k':[1,-2,-2],'8k':[3.5,-1,1]} },
            acoustic: { name: "Acoustic", desc: { lcd2c:"String texture.", arya:"Natural.", stereo:"Clear vocals." }, vals: {64:[0,1,0],125:[-2,0,-2],250:[0,0,-1],500:[-1,-1,-1],'2k':[0,-1,-1],'4k':[2.5,0,-1],'8k':[4.5,1,0]} },
            classical: { name: "Classical", desc: { lcd2c:"Soundstage.", arya:"Cello weight.", stereo:"Concert Hall." }, vals: {64:[0.5,2,1],125:[0,1,-1],250:[0,0,0],500:[0,0,0],'2k':[1,0,-1],'4k':[2,-1,-2],'8k':[4,0,-1]} },
            electronic: { name: "Electronic", desc: { lcd2c:"Sub-bass party.", arya:"Bass cannon.", stereo:"Club mode." }, vals: {64:[5.5,6,5],125:[2,3,1],250:[-1,0,-1],500:[-2,-1,-2],'2k':[-1,-1,0],'4k':[2,0,1],'8k':[5,1,3]} },
            rnb: { name: "R&B", desc: { lcd2c:"Silky vocals.", arya:"Smooth.", stereo:"Lounge vibes." }, vals: {64:[2.5,3.5,2],125:[3,3.5,1],250:[1,1,0],500:[0,0,0],'2k':[-1.5,-1,-1],'4k':[0,-2,-1],'8k':[3,-2,-1]} },
            rap: { name: "Rap", desc: { lcd2c:"808s.", arya:"Beat impact.", stereo:"Sub-bass." }, vals: {64:[5,6,4],125:[1,2,0],250:[0,0,-1],500:[-1,-1,-1],'2k':[1.5,0,0],'4k':[1,-1,-1],'8k':[3,-1,0]} },
            country: { name: "Country", desc: { lcd2c:"Twang.", arya:"Body.", stereo:"Vocal forward." }, vals: {64:[1,2,1],125:[2,2.5,0],250:[2,1,1],500:[-1,0,-1],'2k':[1.5,-1,-1],'4k':[2.5,-1,-1],'8k':[2,-1,0]} },
            funk: { name: "Funk & Soul", desc: { lcd2c:"Bass guitar.", arya:"Groove.", stereo:"Tight bass." }, vals: {64:[2,3,2],125:[4,4,2],250:[0,1,0],500:[-1,-1,-1],'2k':[0,-1,-1],'4k':[2.5,0,-1],'8k':[3,0,1]} },
            reggae: { name: "Reggae", desc: { lcd2c:"Earth shaking.", arya:"Warmth.", stereo:"Max warmth." }, vals: {64:[4.5,5.5,4],125:[5,5,3],250:[1,2,1],500:[0,0,0],'2k':[-1,-1,-1],'4k':[-1,-2,-2],'8k':[1,-2,-2]} }
        };

        // --- STATE ---
        let currentOutput = 'lcd2c';
        let currentPreset = 'neutral';

        // --- DOM ELEMENTS ---
        const els = {
            headerAccent: document.getElementById('header-accent'),
            outputContainer: document.getElementById('output-container'),
            stylesContainer: document.getElementById('styles-container'),
            genresContainer: document.getElementById('genres-container'),
            presetName: document.getElementById('preset-name'),
            presetDesc: document.getElementById('preset-desc'),
            modeBadge: document.getElementById('mode-badge'),
            infoIcon: document.getElementById('info-icon'),
            bgGlow: document.getElementById('bg-glow'),
            bgBlob: document.getElementById('bg-blob'),
            knobsRow: document.getElementById('knobs-row')
        };

        // --- HELPERS ---
        function createKnobs() {
            const freqs = ['64','125','250','500','2k','4k','8k'];
            els.knobsRow.innerHTML = freqs.map(freq => `
                <div class="knob-container flex flex-col items-center w-full" id="knob-${freq}">
                    <span class="text-[10px] font-bold uppercase tracking-widest mb-4 text-slate-500">${freq.replace('k', ' kHz').replace(/^[0-9]+$/, '$& Hz')}</span>
                    <div class="relative w-16 h-16">
                        <svg class="absolute inset-0 w-full h-full opacity-30" viewBox="0 0 100 100"><path d="M20 80 A 40 40 0 1 1 80 80" fill="none" stroke="currentColor" stroke-width="6" stroke-linecap="round" /></svg>
                        <div class="knob-inner w-14 h-14 bg-slate-800 rounded-full absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 border-2 border-slate-700 flex items-center justify-center">
                            <div class="indicator w-1 h-5 rounded-full absolute -top-0.5 bg-slate-500 shadow-sm transition-colors duration-300"></div>
                            <div class="w-full h-full rounded-full bg-gradient-to-tr from-white/10 to-transparent pointer-events-none"></div>
                        </div>
                    </div>
                    <div class="mt-3 flex flex-col items-center gap-1">
                        <div class="val-box flex items-center justify-center w-12 py-0.5 rounded border border-slate-800 bg-slate-900/80">
                            <span class="val-text text-sm font-mono font-bold">0</span>
                        </div>
                        <span class="clock-text text-[10px] font-mono text-slate-600">12:00</span>
                    </div>
                </div>
            `).join('');
        }

        // --- RENDER ---
        function renderOutputs() {
            els.outputContainer.innerHTML = Object.values(CONFIG).map(out => {
                const isActive = currentOutput === out.id;
                return `
                <div class="btn-base relative p-4 rounded-xl border-2 flex flex-col items-center gap-3 ${isActive ? 'bg-slate-900' : 'bg-slate-900/40 opacity-70'}"
                     style="border-color: ${isActive ? out.color : '#1e293b'}; box-shadow: ${isActive ? '0 0 20px '+out.color+'33' : 'none'}"
                     onclick="switchOutput('${out.id}')">
                    <div class="text-2xl" style="color: ${isActive ? out.color : '#64748b'}">${out.icon}</div>
                    <div class="font-bold text-xs md:text-sm ${isActive ? 'text-white' : 'text-slate-400'}">${out.name}</div>
                    ${isActive ? `<div class="absolute top-0 left-0 w-full h-1" style="background:${out.color}"></div>` : ''}
                </div>`;
            }).join('');
        }

        function renderPresets() {
            const styleKeys = ['warmth', 'energetic', 'crisp', 'smooth', 'latenight', 'theater'];
            const genreKeys = Object.keys(PRESETS).filter(k => k !== 'neutral' && !styleKeys.includes(k));
            
            const createBtn = (key) => {
                const isActive = currentPreset === key;
                const color = CONFIG[currentOutput].color;
                return `
                <div class="btn-base px-3 py-3 rounded-lg text-sm font-medium text-left border"
                     style="background-color: ${isActive ? '#1e293b' : 'transparent'}; 
                            border-color: ${isActive ? color+'40' : 'transparent'};
                            border-left: ${isActive ? '4px solid '+color : '1px solid transparent'};
                            color: ${isActive ? 'white' : '#94a3b8'}"
                     onclick="switchPreset('${key}')">
                    ${PRESETS[key].name}
                </div>`;
            };

            els.stylesContainer.innerHTML = styleKeys.map(createBtn).join('');
            els.genresContainer.innerHTML = genreKeys.map(createBtn).join('');
        }

        // --- LOGIC ---
        window.switchOutput = (id) => {
            currentOutput = id;
            currentPreset = 'neutral';
            updateUI();
        };

        window.switchPreset = (key) => {
            currentPreset = key;
            updateUI();
        };

        function updateUI() {
            renderOutputs(); // Re-render for active states
            renderPresets(); // Re-render for active states & color changes

            const config = CONFIG[currentOutput];
            const preset = PRESETS[currentPreset];
            const idx = currentOutput === 'lcd2c' ? 0 : currentOutput === 'arya' ? 1 : 2;

            // Text & Colors
            els.headerAccent.style.color = config.color;
            els.presetName.textContent = preset.name;
            els.presetDesc.textContent = preset.desc[currentOutput];
            els.modeBadge.textContent = config.name + ' Mode';
            els.modeBadge.style.color = config.color;
            els.modeBadge.style.borderColor = config.color;
            els.modeBadge.style.backgroundColor = config.color + '15';
            els.infoIcon.style.color = config.color;
            els.bgGlow.style.background = `linear-gradient(90deg, transparent, ${config.color}, transparent)`;
            els.bgBlob.style.background = config.color;

            // Knobs
            ['64','125','250','500','2k','4k','8k'].forEach(freq => {
                const el = document.getElementById(`knob-${freq}`);
                const val = preset.vals[freq][idx] || 0;
                const isBoost = val > 0.1;
                const isCut = val < -0.1;

                // Math
                const minDb=-6, maxDb=6, minDeg=-150, maxDeg=150;
                const rot = ((val - minDb)/(maxDb - minDb))*(maxDeg - minDeg) + minDeg;
                
                // Styling
                const activeColor = isCut ? '#f43f5e' : (isBoost ? config.color : '#64748b');
                const glow = (isBoost || isCut) ? `0 0 15px ${activeColor}40` : 'none';

                // Apply
                el.querySelector('.knob-inner').style.transform = `translate(-50%, -50%) rotate(${rot}deg)`;
                el.querySelector('.knob-inner').style.boxShadow = glow;
                
                const indicator = el.querySelector('.indicator');
                indicator.style.backgroundColor = activeColor;
                indicator.style.boxShadow = `0 0 5px ${activeColor}`;

                const valBox = el.querySelector('.val-box');
                valBox.style.color = (isBoost || isCut) ? 'white' : '#64748b';
                el.querySelector('.val-text').textContent = (val > 0 ? '+' : '') + val;

                // Clock
                let h = 12 + (val / 1.2);
                if(h > 12.99) h -= 12; if(h < 1) h += 12;
                let m = Math.round((h % 1) * 60);
                el.querySelector('.clock-text').textContent = `${Math.floor(h)}:${m < 10 ? '0'+m : m}`;
            });
        }

        // Init
        createKnobs();
        updateUI();

    </script>
</body>
</html>
